# CNT4007 - Programming Assignment 1
Manu Kolehmainen
UFID: 93281150
email: manu.kolehmainen@ufl.edu

### Compilation
The code works on Windows/Linux/Unix, and can be compiled and ran the same way on each device.
The program is written in java, so a JDK (preferably 1.8 or higher) or JRE is required to be
installed on the device to compile and run the code.
The code can be compiled into jar files and ran using the commands:
`make client`
`java -jar client.jar [server_url/ip] [port]`

`make server`
`java -jar server.jar [port]`

Alternatively, the code can be run directly without compiling into a jar by using
`cd src`
to change the directory to the source directory, and running
`javac client.java`
or
`javac server.java`
to compile the client and server respectively, and then using
`java client [server_url/ip] [port]`
or
`java server [port]`
to run the client and server respectively.

### Functions
Only src/client.java and src/server.java are required for the program to function. The project is 
structured to allow the source files to be compiled into jar files, but this is not required for them to function.

### Results
The client and server behave exactly as specified in the specification document. No abnormal results or bugs were found.
Whenever the server receives input, it parses the input and returns the correct result, either an error code or
the correct calculation. The program is limited in only accepting the three types of arithmetic operations
(add, subtract, multiply) and in only being able to connect to one client at a time (ie. it does not use parallel
processing or threads). These features could easily be added to the server though, but were not requested for this assignment.

#### Client.java
When starting the client, both a valid server URL or IP address are required to be given, along with the port
the server is running on. If the client doesn't receive these values or the requested server does not exist,
the client closes itself with an error. If the server exists, the client attempts to start a connection with it
using `startConnection()` to open a socket between the client and server.
The client attempts a handshake with the server, and if it receives the correct response
it starts handling client-side operations with `handleClient()`, which continues until shut down, calling `stopConnection()`
to close the socket.
While connected to the server, the client continually accepts user input, sending each line to server for validation.
The server then returns the result of the input, either as an error code or the result of the calculation, and the client
displays the result. When receiving -5 from the server, the client shuts down.

#### Server.java
The server must be started before the client. When the server is ran, it opens a socket with
`startServer()` Once the server is active, it can connect to one client at a time,
but does not need to be restarted between client connections. The server handles connecting to clients in
`handleServer()`, and handles input from clients in `handleClient()` while it is connected to a client.
Any valid input from the client is parsed in `handleCalculation()` and the result is returned to the client.

#### Sample output
##### Network
$make network
$java -jar network.jar 9328
Network started on port 0.0.0.00.0.0.0:9328
get connection from receiver 127.0.0.1
get connection from sender 127.0.0.1
Threads started, waiting on them to finish.
Sender Received: PACKET0 1, CORRUPT
Receiver Received: ACK1, DROP
Receiver Received: ACK1, PASS
Sender Received: PACKET0 1, DROP
Sender Received: PACKET0 1, PASS
Receiver Received: ACK0, DROP
Receiver Received: ACK0, DROP
Receiver Received: ACK0, PASS
Sender Received: PACKET1 2, DROP
Sender Received: PACKET1 2, PASS
Receiver Received: ACK1, CORRUPT
Sender Received: PACKET0 3, PASS
Receiver Received: ACK0, PASS
Sender Received: PACKET1 4, DROP
Sender Received: PACKET1 4, DROP
Sender Received: PACKET1 4, DROP
Sender Received: PACKET1 4, PASS
Receiver Received: ACK1, DROP
Receiver Received: ACK1, PASS
Sender Received: PACKET0 5, PASS
Receiver Received: ACK0, PASS
Sender Received: PACKET1 6, PASS
Receiver Received: ACK1, DROP
Receiver Received: ACK1, PASS
Sender Received: PACKET0 7, PASS
Receiver Received: ACK0, DROP
Receiver Received: ACK0, CORRUPT
Sender Received: PACKET1 8, PASS
Receiver Received: ACK1, DROP
Receiver Received: ACK1, CORRUPT
Sender Received: PACKET0 9, DROP
Sender Received: PACKET0 9, DROP
Sender Received: PACKET0 9, DROP
Sender Received: PACKET0 9, CORRUPT
Receiver Received: ACK1, CORRUPT
Sender Received: PACKET0 9, PASS
Receiver Received: ACK0, DROP
Receiver Received: ACK0, PASS
Sender Received: PACKET1 10, PASS
Receiver Received: ACK1, DROP
Receiver Received: ACK1, CORRUPT
Sender Received: PACKET0 11, PASS
Receiver Received: ACK0, CORRUPT
Sender thread exiting...
Sender thread finished.
Receiver thread finished.
Threads finished.
Network closed successfully
*Network terminated*

##### Receiver
$make receiver
$java -jar receiver.jar 0.0.0.0 9328
receive: Network Hello!
Waiting 0, 1, 1, PACKET0 1 318 You, ACK1
Waiting 0, 2, 1, ACK2, ACK1
Waiting 0, 3, 1, PACKET0 1 317 You, ACK0
Waiting 1, 4, 2, ACK2, ACK0
Waiting 1, 5, 2, ACK2, ACK0
Waiting 1, 6, 2, PACKET1 2 312 are, ACK1
Waiting 0, 7, 3, PACKET0 3 230 my, ACK0
Waiting 1, 8, 4, PACKET1 4 923 sunshine., ACK1
Waiting 0, 9, 5, ACK2, ACK1
Waiting 0, 10, 5, PACKET0 5 198 My, ACK0
Waiting 1, 11, 6, PACKET1 6 450 only, ACK1
Waiting 0, 12, 7, ACK2, ACK1
Waiting 0, 13, 7, PACKET0 7 921 sunshine,, ACK0
Waiting 1, 14, 8, ACK2, ACK0
Waiting 1, 15, 8, PACKET1 8 317 You, ACK1
Waiting 0, 16, 9, ACK2, ACK1
Waiting 0, 17, 9, PACKET0 9 415 make, ACK1
Waiting 0, 18, 9, PACKET0 9 414 make, ACK0
Waiting 1, 19, 10, ACK2, ACK0
Waiting 1, 20, 10, PACKET1 10 210 me, ACK1
Waiting 0, 21, 11, ACK2, ACK1
Waiting 0, 22, 11, PACKET0 11 592 happy., ACK0
Received message: You are my sunshine. My only sunshine, You make me happy.
*receiver terminated*

##### Sender
$make sender
$java -jar sender.jar 0.0.0.0 9328 message.txt
receive: Network Hello!
Sending message as packets:
[1]: You, ACK0, digest: 00010000013d596f75
[2]: are, ACK1, digest: 010200000138617265
[3]: my, ACK0, digest: 0003000000e66d79
[4]: sunshine., ACK1, digest: 01040000039b73756e7368696e652e
[5]: My, ACK0, digest: 0005000000c64d79
[6]: only, ACK1, digest: 0106000001c26f6e6c79
[7]: sunshine,, ACK0, digest: 00070000039973756e7368696e652c
[8]: You, ACK1, digest: 01080000013d596f75
[9]: make, ACK0, digest: 00090000019e6d616b65
[10]: me, ACK1, digest: 010a000000d26d65
[11]: happy., ACK0, digest: 000b0000025068617070792e
Waiting ACK0, 1, CORRUPT, resend Packet0
Waiting ACK0, 2, DROP, resend Packet0
Waiting ACK0, 3, PASS, sending next Packet1
Waiting ACK1, 4, DROP, resend Packet1
Waiting ACK1, 5, PASS, sending next Packet0
Waiting ACK0, 6, PASS, sending next Packet1
Waiting ACK1, 7, DROP, resend Packet1
Waiting ACK1, 8, DROP, resend Packet1
Waiting ACK1, 9, DROP, resend Packet1
Waiting ACK1, 10, PASS, sending next Packet0
Waiting ACK0, 11, PASS, sending next Packet1
Waiting ACK1, 12, PASS, sending next Packet0
Waiting ACK0, 13, PASS, sending next Packet1
Waiting ACK1, 14, PASS, sending next Packet0
Waiting ACK0, 15, DROP, resend Packet0
Waiting ACK0, 16, DROP, resend Packet0
Waiting ACK0, 17, DROP, resend Packet0
Waiting ACK0, 18, CORRUPT, resend Packet0
Waiting ACK0, 19, PASS, sending next Packet1
Waiting ACK1, 20, PASS, sending next Packet0
Waiting ACK0, 21, no more packets to send
*sender terminated*